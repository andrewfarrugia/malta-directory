---
import type { LocalPexelsImage } from "@/lib/pexelsImagePipeline";
import { toPictureData } from "@/lib/pexelsImagePipeline";

interface FeaturedServiceItem {
  title: string;
  locality: string;
  meta: string;
  href: string;
  ctaLabel: string;
  image: LocalPexelsImage;
}

interface Props {
  title: string;
  items: FeaturedServiceItem[];
}

const { title, items } = Astro.props as Props;
---
<section class="section section--muted">
  <div class="container">
    <h2>{title}</h2>
    <div class="featured-grid">
      {items.map((item) => {
        const image = toPictureData(item.image);
        return (
          <article class="card featured-service-card">
            <a href={item.href} class="featured-service-media">
              <picture>
                <source type="image/webp" srcset={image.webpSrcset} />
                <source type="image/jpeg" srcset={image.jpgSrcset} />
                <img src={image.src} alt={image.alt} width={image.width} height={image.height} loading="lazy" />
              </picture>
            </a>
            <p class="meta">{item.locality}</p>
            <h3><a href={item.href}>{item.title}</a></h3>
            <p class="meta">{item.meta}</p>
            <a class="btn btn--secondary" href={item.href}>{item.ctaLabel}</a>
            {image.photographer && image.photographerUrl && (
              <p class="meta featured-attribution">
                Photo by <a href={image.photographerUrl} rel="noopener nofollow" target="_blank">{image.photographer}</a> on Pexels
              </p>
            )}
          </article>
        );
      })}
    </div>
  </div>
</section>
